### **程序简介：URL 和 MP4 检查工具**

这款工具可以从 Excel 文件中提取 URL，并批量检查这些链接的状态，验证其是否有效及是否指向 MP4 视频文件。检查结果会分类保存为两个文件：健康链接（指向有效 MP4 文件）和失效链接（无效或错误的链接）。此外，程序支持定时任务，可以定期自动检测链接状态，并保存检测结果。

---

### **主要功能：**
1. **URL 提取：** 从 Excel 文件的内容中自动提取所有 URL（包括嵌入在文本中的链接）。
2. **URL 状态检查：** 并发地检查 URL 是否有效，提升检测速度。
3. **MP4 验证：** 检查 URL 是否指向 MP4 文件。
4. **结果分类保存：** 
   - **健康链接：** 保存指向有效 MP4 文件的链接。
   - **失效链接：** 保存无效或错误链接。
5. **定时检测：** 用户可设置检测间隔，程序会定期运行并更新检测结果。
6. **用户配置管理：** 支持保存文件路径和检测间隔设置，方便下次启动。

---

### **程序用法：**

#### **1. 环境准备**
- 确保系统安装了 Python 3.x。
- 安装必要依赖库：
  ```bash
  pip install pandas requests tqdm openpyxl schedule
  ```

#### **2. 启动程序**
运行程序：
```bash
python your_script_name.py
```

#### **3. 输入设置**
- **首次运行：**
  - 输入 Excel 文件路径（包含需要检测的 URL）。
  - 设置检测时间间隔（以分钟为单位，默认为 60 分钟）。
  - 程序会询问是否保存设置，以供下次启动使用。
- **后续运行：**
  - 程序会自动加载之前保存的设置。

#### **4. 检测结果**
- 程序运行后会在 Excel 文件所在目录生成两个文件：
  - `健康链接.txt`：包含有效的 MP4 链接。
  - `失效链接.txt`：包含无效或错误的链接。

#### **5. 定时任务**
- 程序会在后台定时运行，按设置的时间间隔检测 URL 状态。

---

### **注意事项：**
1. **Excel 文件格式：** 支持 `.xlsx` 格式，URL 可分布在任意单元格中。
2. **网络稳定性：** 确保网络连接正常，否则可能导致部分链接检测失败。
3. **设置文件：** 程序会在运行目录下生成 `settings.json` 用于保存用户配置，可手动删除以重新设置。
4. **操作系统兼容性：** 支持 Windows、macOS 和 Linux 系统。

---

这款工具适合需要批量管理和监控链接状态的用户，尤其是在需要验证视频文件有效性的场景中。
